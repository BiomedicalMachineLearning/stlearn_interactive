{% extends 'base.html' %}

{% block content %}
	{# Below block indicates whether pre-processing already completed #}
	{% if preprocessed %}
	<div class="container">
	    {% for message in get_flashed_messages() %}
	    <div class="alert alert-warning">
	        <button type="button" class="close" data-dismiss="alert">&times;</button>
	        {{ message }}
	    </div>
	    {% endfor %}

	    {% block page_content %}{% endblock %}
	</div>
	{% endif %}

	{# Pre-processing form #}
    <div class="card">
       <div class="card-header card-header-primary">
            <h4 class="card-title">Preprocessing</h4>
       </div>
       <div class="card-body">
            <form id="registerForm" class="form form-register" method="POST" action="" role="form">
               {{ superForm.csrf_token }}
                {# Iterating through and adding each element appropriately #}
                {% for element in superForm.elements %}

                    {# Determining Field type #}
                    {% if superForm['element_fields'][loop.index0] == 'Title' %}
                        <h3 class="mt-5">{{ element }}</h3>

                    {% elif superForm['element_fields'][loop.index0] == 'SelectMultipleField' %}
                        {# Staggering so appears side-by-side #}
                        {% if superForm[element+'_number']%2 != 0 %}

                            <div style="width: 300px; float: left;" class="form_group">
                                {{ superForm[element].label }}
                                {{ superForm[element](class_="form-control") }}
                            </div>

                        {% else %}
                            <div style="width: 300px; margin-left: 320px;" class="form_group">
                                {{ superForm[element].label }}
                                {{ superForm[element](class_="form-control") }}
                            </div>
                        {% endif %}

                    {% elif superForm['element_fields'][loop.index0] == 'StringField' %}
                        <div class="form-group">
                            {{ element }}
                            {{ superForm[element](
                                      placeholder=superForm[element+'_placeholder'],
                                                            class_="form-control")}}
                        </div>

                    {% elif superForm['element_fields'][loop.index0] == 'SelectField' %}
                        <div class="form-group">
                            {{ element }}
                            {{ superForm[element](class_="form-control")}}
                        </div>

                    {% elif superForm['element_fields'][loop.index0] == 'IntegerField' %}
                        <div class="form-group">
                            {{ element }}
                            {{ superForm[element](
                                      value=superForm[element+'_placeholder'],
                                                            class_="form-control")}}
                        </div>

                    {% elif superForm['element_fields'][loop.index0] == 'BooleanField' %}
                        <div class="form-group">
                            {{ element }}
                            {{ superForm[element](
                                      checked=superForm[element+'_placeholder'],
                                                            class_="form-control")}}
                        </div>

                    {% endif %}
                {% endfor %}

                {# Button which controls form submission #}
                <p><input class="btn btn-primary" type="submit" value={{"Submit"}}></p>
            </form>
       </div>
    </div>
	
{% endblock %}

{% block status %}

    {% for key, value in step_log.items() %}
        {% if 'preprocessed_params' != key %}
            {% if value[0] %}
                <li class="list-group-item"><span class="badge badge-pill badge-success">Success</span> {{ value[1] }} </li>
            {% else %}
                <li class="list-group-item"><span class="badge badge-pill badge-danger">None</span> {{ value[1] }} </li>
            {% endif %}
        {% endif %}
    {% endfor %}

{% endblock %}
